<!DOCTYPE html>
<html>
    <head>
        <title>Set Name - Practice Stacks</title>
        <link rel="stylesheet", href="./themes/core.css">
        <link rel="stylesheet", href="./themes/spots.css">
        <style>
            .navbar-right {
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
        </style>
    </head>
    <body>
        <div class="navbar">
            <div class="navbar-content navbar-content-width-full">
                <div class="navbar-left">
                    <h2 class="page-title"><span id="player-current-count"></span> Spot<span id="player-spot-plural">s</span>&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;<span id="player-duration"></span> left</h2>
                </div>
                <div style="width: calc(80% - 450px);" class="navbar-space"></div>
                <div class="navbar-right">
                    <h3 class="navbar-link"><a href="./index.html" style="color:#fff">Back to Home</a></h3>
                </div>
            </div>
        </div>
        <div class="mainpage-content-dynamic">

            <script type="text/javascript" src="./js/storage/data.js"></script>
            <script type="text/javascript" src="./js/storage/colors.js"></script>

            <script>let spots = data.spots; let stack = data.stack;</script>

            <script type="text/javascript" src="./js/algorithms/time.js"></script>

            <script type="text/javascript" src="./js/shuffle.js"></script>

            <script type="text/javascript" src="./js/player/player.js"></script>
            
            <script type="text/javascript" src="./js/youtube_api/core.js"></script>
            <script type="text/javascript" src="./js/youtube_api/key.js"></script>
            <script type="text/javascript" src="./js/youtube_api/video_details.js"></script>

            <script type="text/javascript" src="./js/storage/cache_reload.js"></script>

            <div class="content-box player-stack-list">
                <div class="content-box spots-list" id="spots-list">

                </div>
            </div>

            <script>

                let spots_list = document.getElementById('spots-list');

                let shuffle_list = player.get_shuffled_list();

                shuffle_list.forEach(async (spot,i) => {

                    spots_list.insertAdjacentHTML("beforeend",`
                        <div class="spots-list-element-container" id="spots-element-container-index-${i}">
                            <div class="spots-list-element" id="spots-element-index-${i}">
                                <div class="spots-list-element-data">
                                    <div class="spots-list-element-data-container">
                                        <h3 class="spots-list-element-data spots-list-element-data-duration">${time.get_dhms((!spot.cache) ? 0 : (spot.cache.duration || 0))}</h3>
                                        <h2 class="spots-list-element-data-title">${(!spot.cache) ? 'Unknown (cache was cleared)' : (spot.cache.title.length > 60) ? spot.cache.title.substr(0,60).trim() + "..." : spot.cache.title}</h2>
                                    </div>
                                    <div class="spots-list-element-data-container">
                                        <a href="https://youtube.com/watch?v=${spot.id}"><h3 class="spots-list-element-data spots-list-element-data-link">https://youtube.com/watch?v=${spot.id}</h3></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `)
                })

                document.getElementById('player-current-count').innerHTML = shuffle_list.length;

                document.getElementById('player-spot-plural').innerHTML = (shuffle_list.length == 1) ? '' : 's';

                document.getElementById('player-duration').innerHTML = time.get_dhms(shuffle_list.map((v)=>{return (v.cache && v.cache.duration) ? v.cache.duration : 0}).reduce((a,b) => a + b));

                spots.cache_reload();

            </script>

        </div>
    </body>
</html>